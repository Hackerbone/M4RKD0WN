(this.webpackJsonpirida=this.webpackJsonpirida||[]).push([[0],{156:function(e,t,a){},157:function(e,t,a){},169:function(e,t,a){},170:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},189:function(e,t){},191:function(e,t){},215:function(e,t,a){},221:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),r=a(27),s=a.n(r),o=a(11),l=a(13),i=(a(156),a(69)),d=a(20),j=(a(157),a(106)),u=a(108),b=a.n(u),h=a(242),m=a(243),O=a(237),f=a(99),x=a(5);var g=function(e){var t=Object(c.useRef)(),a=function(e){e.preventDefault();var a,c="";c=""===e.target.name.value?"Anonymous":e.target.name.value,a=e.target.issue.value,f.a.database().ref("Users").orderByChild("profile/engaged").once("value",(function(e){if(e.forEach((function(e){0===e.val().profile.engaged&&(t=e.val())})),t.profile){var n=function(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=a.length,n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*c));return t}(6);console.log(t);var r=f.a.database().ref("rooms").child(n),s=new Date,o={volunteer:t.profile.name,createdAt:s,cient:c,issue:a,cert:t.profile.cert};r.set(o,(function(e){e&&console.log(e)})),f.a.database().ref("Users").orderByChild("profile/cert").equalTo(t.profile.cert).once("value").then((function(e){e.forEach((function(e){return e.ref.child("profile").update({engaged:1,tempRoomId:n}).then((function(){window.location.href="/room/"+n})),!0}))}))}else alert("No available volunteers, please wait for some time.. ")})).catch((function(e){var t=e.code,a=e.message;console.log(a,t)}))};return Object(x.jsxs)(h.a,Object(o.a)(Object(o.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(x.jsx)(h.a.Header,{closeButton:!0,children:Object(x.jsx)(h.a.Title,{id:"contained-modal-title-vcenter",children:"Enter details"})}),Object(x.jsx)(h.a.Body,{children:Object(x.jsxs)(m.a,{onSubmit:function(e){return a(e)},children:[Object(x.jsxs)(m.a.Group,{controlId:"formGridName",children:[Object(x.jsx)(m.a.Label,{children:"Name"}),Object(x.jsx)(m.a.Control,{name:"name",placeholder:"Anonymous"})]}),Object(x.jsxs)(m.a.Group,{controlId:"formGridIssue",children:[Object(x.jsx)(m.a.Label,{children:"What type of issue are you facing?"}),Object(x.jsx)(m.a.Control,{name:"issue",placeholder:"Stress, Anxiety, ...."})]}),Object(x.jsx)(O.a,{variant:"success",type:"submit",children:"Join Room"})]})}),Object(x.jsx)(h.a.Footer,{children:Object(x.jsx)(O.a,{onClick:e.onHide,children:"Close"})})]}))},p=function(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],r=Object(j.useSpring)({from:{transform:"scale(1.5)",overflow:"hidden"},to:{transform:"scale(1)",overflow:"hidden"},config:{duration:500}});return Object(c.useEffect)((function(){b()("#root").addClass("overflow-none"),setTimeout((function(){b()("#root").removeClass("overflow-none")}),1e3)}),[]),Object(x.jsxs)(j.animated.section,{style:r,className:"home",children:[Object(x.jsx)("div",{className:"bg-skew"}),Object(x.jsxs)("div",{className:"center-out",children:[Object(x.jsxs)("h2",{children:[" ",Object(x.jsx)("b",{children:"You are doing well! Lets converse "})]}),Object(x.jsx)("h4",{children:"To get started click the button below"}),Object(x.jsx)("div",{className:"call-button",onClick:function(){return n(!a)},children:Object(x.jsx)("i",{className:"fas fa-phone-alt"})})]}),Object(x.jsx)(g,{show:a,onHide:function(){return n(!1)}})]})},v=a(245),w=a(244),y=a(98),N=(a(164),a(165),y.a.apps.length?y.a.app():y.a.initializeApp({apiKey:"AIzaSyDnFMvqkULMTKi83QrG_QyietKYoiah6sI",authDomain:"ek-database.firebaseapp.com",projectId:"ek-database",storageBucket:"ek-database.appspot.com",messagingSenderId:"503059163051",appId:"1:503059163051:web:2b85294379d4e4fadc94ee"})),k=function(e){var t=e.logged,a=e.setLogged;return Object(x.jsxs)(v.a,{fixed:"top",collapseOnSelect:!0,expand:"sm",variant:"dark",children:[Object(x.jsx)(i.b,{to:"/",children:Object(x.jsx)(v.a.Brand,{className:"logo-text",children:"ek"})}),Object(x.jsx)(v.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(x.jsx)(v.a.Collapse,{id:"responsive-navbar-nav",children:t?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(w.a,{className:"ml-auto",children:Object(x.jsx)(i.b,{to:"/dashboard",children:Object(x.jsx)(v.a.Text,{className:"mx-3",children:"Dashboard"})})}),Object(x.jsx)(w.a,{children:Object(x.jsx)(O.a,{variant:"danger",onClick:function(){var e=N.auth().currentUser.uid;N.database().ref("Users").child(e+"/profile").update({engaged:1}),N.auth().signOut(),a(!1)},children:Object(x.jsx)(v.a.Text,{className:"mx-3",children:"Logout"})})})]}):Object(x.jsx)(w.a,{className:"ml-auto",children:Object(x.jsx)(i.b,{to:"/volunteer",children:Object(x.jsx)(v.a.Text,{className:"mx-3",children:"Volunteer here"})})})})]})},S=(a(168),a(169),a(238)),C=a(239),I=a(144),L=(a(170),function(e){var t=e.auth,a=e.setAuth,c=(e.logged,e.setLogged);return N.auth().onAuthStateChanged((function(e){c(!!e)})),Object(x.jsx)("section",{className:"signin w-75",children:Object(x.jsxs)(m.a,{className:"form-neo",onSubmit:function(e){e.preventDefault(),""===e.target.email.value||""===e.target.pwd.value?alert("Login details cannot be empty"):N.auth().signInWithEmailAndPassword(e.target.email.value,e.target.pwd.value).then((function(e){var t=N.auth().currentUser.uid;N.database().ref("Users").child(t+"/profile").update({engaged:0}),alert("Login Successful"),c(!0)})).catch((function(e){alert(e)}))},children:[Object(x.jsx)(m.a.Row,{children:Object(x.jsxs)("h3",{className:"py-2",children:["Signin | ",Object(x.jsx)("span",{className:"logo-text mx-0",children:"ek   "})]})}),Object(x.jsxs)(m.a.Group,{controlId:"formGridEmail",children:[Object(x.jsx)(m.a.Label,{children:"Email"}),Object(x.jsx)(m.a.Control,{name:"email",type:"email",placeholder:"Enter email"})]}),Object(x.jsxs)(m.a.Group,{controlId:"formGridPassword",children:[Object(x.jsx)(m.a.Label,{children:"Password"}),Object(x.jsx)(m.a.Control,{name:"pwd",type:"password",placeholder:"Password"})]}),Object(x.jsx)(O.a,{variant:"primary",type:"submit",children:"Login"}),Object(x.jsx)(m.a.Row,{children:Object(x.jsxs)("span",{className:"my-2",children:["Don't have an account ? ",Object(x.jsx)("span",{className:"text-primary",onClick:function(){return a(!t)},children:"Signup"})]})})]})})}),A=(a(171),function(e){return N.auth().onAuthStateChanged((function(t){t&&e.setLogged(1)})),Object(x.jsxs)(m.a,{className:"form-neo",onSubmit:function(e){e.preventDefault(),console.log(e.target.name.value);var t=e.target.email.value,a=e.target.pwd.value;N.auth().createUserWithEmailAndPassword(t,a).then((function(t){var a=t.user,c=N.database().ref("Users").child(a.uid),n=new Date,r={name:e.target.name.value,mobile:e.target.phone.value,cert:e.target.certID.value,created:n.getTime(),engaged:0};c.set({profile:r},(function(e){e&&alert(e)}))})).catch((function(e){var t=e.code,a=e.message;alert(a,t)}))},children:[Object(x.jsx)(m.a.Row,{children:Object(x.jsxs)("h3",{className:"py-2",children:["Volunteer Signup | ",Object(x.jsx)("span",{className:"logo-text mx-0",children:"ek"})]})}),Object(x.jsxs)(m.a.Row,{children:[Object(x.jsxs)(m.a.Group,{as:I.a,controlId:"formGridName",children:[Object(x.jsx)(m.a.Label,{children:"Name"}),Object(x.jsx)(m.a.Control,{name:"name",placeholder:"Enter fullname"})]}),Object(x.jsxs)(m.a.Group,{as:I.a,controlId:"formGridPassword",children:[Object(x.jsx)(m.a.Label,{children:"Password"}),Object(x.jsx)(m.a.Control,{name:"pwd",type:"password",placeholder:"Password"})]})]}),Object(x.jsxs)(m.a.Group,{controlId:"formGridEmail",children:[Object(x.jsx)(m.a.Label,{children:"Email"}),Object(x.jsx)(m.a.Control,{name:"email",type:"email",placeholder:"Enter email"})]}),Object(x.jsxs)(m.a.Group,{controlId:"formGridMobile",children:[Object(x.jsx)(m.a.Label,{children:"Phone Number"}),Object(x.jsx)(m.a.Control,{name:"phone",placeholder:"+91 0000000000"})]}),Object(x.jsxs)(m.a.Group,{controlId:"formCertificationId",children:[Object(x.jsxs)(m.a.Label,{children:["Certification ID ",Object(x.jsxs)("b",{children:["(   If not certified ",Object(x.jsx)("a",{href:"https://nhsvolunteerresponders.org.uk/volunteer-resources",children:" click here "}),") "]})," "]}),Object(x.jsx)(m.a.Control,{name:"certID",placeholder:"Certification ID"})]}),Object(x.jsx)(m.a.Group,{id:"formGridCheckbox",children:Object(x.jsx)(m.a.Check,{type:"checkbox",label:"Agree to company's terms and conditions"})}),Object(x.jsx)(O.a,{variant:"success",type:"submit",children:"Signup"}),Object(x.jsx)(m.a.Row,{children:Object(x.jsxs)("span",{className:"my-2",children:["Already have an account ? ",Object(x.jsx)("span",{className:"text-primary",onClick:function(){return e.setAuth(!e.auth)},children:"Login"})]})})]})}),G=(a(172),function(e){var t=e.logged,a=e.setLogged,n=Object(c.useState)(0),r=Object(l.a)(n,2),s=r[0],o=r[1];return Object(x.jsx)(S.a,{className:"auth",fluid:!0,children:Object(x.jsxs)(C.a,{className:"w-100 mx-auto",children:[Object(x.jsx)(I.a,{className:"banner text-light d-md-flex d-none align-items-center",children:Object(x.jsxs)("div",{className:"banner-content",children:[Object(x.jsx)("b",{children:Object(x.jsx)("h1",{children:"Get Certified"})}),Object(x.jsx)("p",{className:"w-75 h5",children:"Working as a volunteer to help others requires a skill. Enroll in our programme to become a certified volunteer. "}),Object(x.jsx)(O.a,{href:"https://nhsvolunteerresponders.org.uk/i-want-to-volunteer",children:"Enroll now"})]})}),Object(x.jsx)(I.a,{md:5,className:"d-flex justify-content-center align-items-center",children:s?Object(x.jsx)(L,{auth:s,setAuth:o,logged:t,setLogged:a}):Object(x.jsx)(A,{auth:s,setAuth:o,logged:t,setLogged:a})})]})})}),E=function(){var e=Object(c.useState)(0),t=Object(l.a)(e,2),a=t[0],n=t[1],r=Object(c.useCallback)((function(){var e=N.auth().currentUser;n(e);var t=e.uid;N.database().ref("Users").child(t+"/profile").on("value",(function(e){n(e.val())}))}),[n]);return Object(c.useEffect)((function(){r()}),[r]),Object(x.jsx)(S.a,{className:"auth",fluid:!0,children:Object(x.jsx)(C.a,{className:"w-100 mx-auto",children:Object(x.jsxs)(I.a,{className:"d-flex justify-content-center align-items-center flex-column",children:[Object(x.jsxs)("h1",{children:["Welcome ",a.name," !"]}),Object(x.jsx)("h3",{children:a.cert}),Object(x.jsx)("h3",{children:a.tempRoomId?window.location.href="/room/"+a.tempRoomId+"v0lUn":Object(x.jsx)(x.Fragment,{})}),Object(x.jsxs)("h3",{children:[a.engaged?"Engaged":"Available"," "]})]})})})},U=a(240),D=a(241),R=a(146),T=a.n(R),P=a(111),B=a.n(P),F=a(145),M=a.n(F),W=(a(215),M.a.connect("https://ek-backend.herokuapp.com")),q=function(e){var t=Object(c.useState)(0),a=Object(l.a)(t,2),n=a[0],r=a[1],s=Object(c.useState)(0),o=Object(l.a)(s,2),i=o[0],d=o[1],j=Object(c.useState)(""),u=Object(l.a)(j,2),b=u[0],h=u[1],m=Object(c.useState)(),O=Object(l.a)(m,2),f=O[0],g=O[1],p=Object(c.useState)(!1),v=Object(l.a)(p,2),w=v[0],y=v[1],k=Object(c.useState)(""),S=Object(l.a)(k,2),C=S[0],I=S[1],L=Object(c.useState)(),A=Object(l.a)(L,2),G=A[0],E=A[1],R=Object(c.useState)(!1),P=Object(l.a)(R,2),F=P[0],M=P[1],q=Object(c.useState)(!1),z=Object(l.a)(q,2),H=z[0],J=z[1],K=Object(c.useState)(""),Q=Object(l.a)(K,2),V=Q[0],Y=Q[1],X=Object(c.useRef)(),Z=Object(c.useRef)(),_=Object(c.useRef)();console.log(e),Object(c.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){g(e),X.current.srcObject=e})),W.on("me",(function(t){h(t),console.log(t);var a=N.database().ref("rooms").child(e.match.params.id.slice(0,6));6===e.match.params.id.length?a.update({userSocketId:t},(function(e){e&&console.log(e)})):a.update({volunteerSocketId:t},(function(e){e&&console.log(e)}))})),W.on("callUser",(function(e){y(!0),I(e.from),Y(e.name),E(e.signal)})),N.database().ref("rooms").child(e.match.params.id.slice(0,6)).on("value",(function(e){r(e.val()),console.log(e.val()),d(e.val().cert)}))}),[e.match.params.id]);return Object(x.jsxs)("section",{className:"room",children:[Object(x.jsx)("h1",{style:{textAlign:"center",color:"#fff"},children:"ek"}),Object(x.jsxs)("div",{className:"container",children:[Object(x.jsxs)("div",{className:"video-container",children:[Object(x.jsx)("div",{className:"video",children:f&&Object(x.jsx)("video",{playsInline:!0,muted:!0,ref:X,autoPlay:!0,style:{width:"300px"}})}),Object(x.jsx)("div",{className:"video",children:F&&!H?Object(x.jsx)("video",{playsInline:!0,ref:Z,autoPlay:!0,style:{width:"300px"}}):null})]}),n?console.log(n):Object(x.jsx)(x.Fragment,{}),Object(x.jsx)("div",{className:"myId",children:Object(x.jsxs)("div",{className:"call-button",children:[F&&!H?Object(x.jsx)(U.a,{variant:"contained",color:"secondary",onClick:function(){(J(!0),e.match.params.id.length>6)?(N.database().ref("rooms").child(e.match.params.id.slice(0,6)).remove(),console.log("=========="),console.log(n),console.log("-----------"),console.log(i),n.profile?N.database().ref("Users").orderByChild("profile/cert").equalTo(i).child("tempRoomId").remove():window.location.href="/"):window.location.href="/";_.current.destroy()},children:"End Call"}):Object(x.jsx)(x.Fragment,{children:n.volunteerSocketId?Object(x.jsx)(D.a,{color:"primary","aria-label":"call",onClick:function(){return function(e){var t=new B.a({initiator:!0,trickle:!1,stream:f});t.on("signal",(function(t){W.emit("callUser",{userToCall:e,signalData:t,from:b,name:V})})),t.on("stream",(function(e){Z.current.srcObject=e})),W.on("callAccepted",(function(e){M(!0),t.signal(e)})),_.current=t}(n.volunteerSocketId)},children:Object(x.jsx)(T.a,{fontSize:"large"})}):Object(x.jsx)(x.Fragment,{})}),n.volunteerSocketId?n.volunteerSocketId:Object(x.jsx)(x.Fragment,{})]})}),Object(x.jsx)("div",{children:w&&!F?Object(x.jsxs)("div",{className:"caller",children:[Object(x.jsxs)("h1",{children:[V," is calling..."]}),Object(x.jsx)(U.a,{variant:"contained",color:"primary",onClick:function(){M(!0);var e=new B.a({initiator:!1,trickle:!1,stream:f});e.on("signal",(function(e){W.emit("answerCall",{signal:e,to:C})})),e.on("stream",(function(e){Z.current.srcObject=e})),e.signal(G),_.current=e},children:"Answer"})]}):null})]})]})},z=a(30);var H=function(){var e=Object(c.useState)(0),t=Object(l.a)(e,2),a=t[0],n=t[1],r=Object(z.a)();return Object(x.jsxs)(i.a,{history:r,children:[Object(x.jsx)(k,{logged:a,setLogged:n}),a?Object(x.jsxs)(d.d,{children:[Object(x.jsx)(d.b,{exact:!0,path:"/room/:id",render:function(e){return Object(x.jsx)(q,Object(o.a)({},e))}}),Object(x.jsx)(d.b,{path:"/dashboard",exact:!0,component:function(){return Object(x.jsx)(E,{setLogged:n})}}),Object(x.jsx)(d.b,{path:"/",render:function(){return Object(x.jsx)(d.a,{to:"/dashboard"})}})]}):Object(x.jsxs)(d.d,{children:[Object(x.jsx)(d.b,{exact:!0,path:"/room/:id",render:function(e){return Object(x.jsx)(q,Object(o.a)({},e))}}),Object(x.jsx)(d.b,{exact:!0,path:"/volunteer",children:Object(x.jsx)(G,{logged:a,setLogged:n})}),Object(x.jsx)(d.b,{path:"/",children:Object(x.jsx)(p,{})})]})]})};s.a.render(Object(x.jsx)(n.a.StrictMode,{children:Object(x.jsx)(H,{})}),document.getElementById("root"))}},[[221,1,2]]]);
//# sourceMappingURL=main.69a8184c.chunk.js.map